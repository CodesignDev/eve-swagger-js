<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>api/character/CharacterCorporation.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Agents.html">Agents</a></li><li><a href="Alliance.html">Alliance</a><ul class='methods'><li data-type='method'><a href="Alliance.html#corporations">corporations</a></li><li data-type='method'><a href="Alliance.html#icon">icon</a></li><li data-type='method'><a href="Alliance.html#info">info</a></li></ul></li><li><a href="Alliances.html">Alliances</a><ul class='methods'><li data-type='method'><a href="Alliances.html#all">all</a></li><li data-type='method'><a href="Alliances.html#get">get</a></li><li data-type='method'><a href="Alliances.html#names">names</a></li></ul></li><li><a href="Api.html">Api</a></li><li><a href="Autopilot.html">Autopilot</a><ul class='methods'><li data-type='method'><a href="Autopilot.html#append">append</a></li><li data-type='method'><a href="Autopilot.html#destination">destination</a></li><li data-type='method'><a href="Autopilot.html#prepend">prepend</a></li></ul></li><li><a href="Bloodlines.html">Bloodlines</a><ul class='methods'><li data-type='method'><a href="Bloodlines.html#all">all</a></li></ul></li><li><a href="Bookmarks.html">Bookmarks</a><ul class='methods'><li data-type='method'><a href="Bookmarks.html#all">all</a></li><li data-type='method'><a href="Bookmarks.html#folders">folders</a></li></ul></li><li><a href="Calendar.html">Calendar</a><ul class='methods'><li data-type='method'><a href="Calendar.html#event">event</a></li><li data-type='method'><a href="Calendar.html#recent">recent</a></li></ul></li><li><a href="Categories.html">Categories</a><ul class='methods'><li data-type='method'><a href="Categories.html#all">all</a></li><li data-type='method'><a href="Categories.html#get">get</a></li></ul></li><li><a href="Category.html">Category</a><ul class='methods'><li data-type='method'><a href="Category.html#info">info</a></li></ul></li><li><a href="Character.html">Character</a><ul class='methods'><li data-type='method'><a href="Character.html#assets">assets</a></li><li data-type='method'><a href="Character.html#clones">clones</a></li><li data-type='method'><a href="Character.html#fleet">fleet</a></li><li data-type='method'><a href="Character.html#killmails">killmails</a></li><li data-type='method'><a href="Character.html#kills">kills</a></li><li data-type='method'><a href="Character.html#location">location</a></li><li data-type='method'><a href="Character.html#recentKillmails">recentKillmails</a></li><li data-type='method'><a href="Character.html#recentKills">recentKills</a></li><li data-type='method'><a href="Character.html#ship">ship</a></li><li data-type='method'><a href="Character.html#skillqueue">skillqueue</a></li><li data-type='method'><a href="Character.html#skills">skills</a></li><li data-type='method'><a href="Character.html#wallets">wallets</a></li></ul></li><li><a href="CharacterCorporation.html">CharacterCorporation</a><ul class='methods'><li data-type='method'><a href="CharacterCorporation.html#history">history</a></li><li data-type='method'><a href="CharacterCorporation.html#icon">icon</a></li><li data-type='method'><a href="CharacterCorporation.html#id">id</a></li><li data-type='method'><a href="CharacterCorporation.html#info">info</a></li><li data-type='method'><a href="CharacterCorporation.html#members">members</a></li><li data-type='method'><a href="CharacterCorporation.html#roles">roles</a></li></ul></li><li><a href="CharacterInfo.html">CharacterInfo</a><ul class='methods'><li data-type='method'><a href="CharacterInfo.html#history">history</a></li><li data-type='method'><a href="CharacterInfo.html#info">info</a></li><li data-type='method'><a href="CharacterInfo.html#portrait">portrait</a></li></ul></li><li><a href="Characters.html">Characters</a><ul class='methods'><li data-type='method'><a href="Characters.html#get">get</a></li><li data-type='method'><a href="Characters.html#names">names</a></li></ul></li><li><a href="Colonies.html">Colonies</a><ul class='methods'><li data-type='method'><a href="Colonies.html#all">all</a></li><li data-type='method'><a href="Colonies.html#layout">layout</a></li></ul></li><li><a href="Constellations.html">Constellations</a><ul class='methods'><li data-type='method'><a href="Constellations.html#names">names</a></li></ul></li><li><a href="Contact.html">Contact</a><ul class='methods'><li data-type='method'><a href="Contact.html#remove">remove</a></li><li data-type='method'><a href="Contact.html#update">update</a></li><li data-type='method'><a href="Contact.html#updateWatched">updateWatched</a></li></ul></li><li><a href="Contacts.html">Contacts</a><ul class='methods'><li data-type='method'><a href="Contacts.html#add">add</a></li><li data-type='method'><a href="Contacts.html#addWatched">addWatched</a></li><li data-type='method'><a href="Contacts.html#all">all</a></li><li data-type='method'><a href="Contacts.html#get">get</a></li><li data-type='method'><a href="Contacts.html#labels">labels</a></li></ul></li><li><a href="Corporation.html">Corporation</a><ul class='methods'><li data-type='method'><a href="Corporation.html#history">history</a></li><li data-type='method'><a href="Corporation.html#icon">icon</a></li><li data-type='method'><a href="Corporation.html#info">info</a></li></ul></li><li><a href="Corporations.html">Corporations</a><ul class='methods'><li data-type='method'><a href="Corporations.html#get">get</a></li><li data-type='method'><a href="Corporations.html#names">names</a></li></ul></li><li><a href="Event.html">Event</a><ul class='methods'><li data-type='method'><a href="Event.html#accept">accept</a></li><li data-type='method'><a href="Event.html#info">info</a></li><li data-type='method'><a href="Event.html#reject">reject</a></li><li data-type='method'><a href="Event.html#undecided">undecided</a></li></ul></li><li><a href="Factions.html">Factions</a><ul class='methods'><li data-type='method'><a href="Factions.html#all">all</a></li></ul></li><li><a href="Fitting.html">Fitting</a><ul class='methods'><li data-type='method'><a href="Fitting.html#del">del</a></li></ul></li><li><a href="Fittings.html">Fittings</a><ul class='methods'><li data-type='method'><a href="Fittings.html#add">add</a></li><li data-type='method'><a href="Fittings.html#all">all</a></li><li data-type='method'><a href="Fittings.html#get">get</a></li></ul></li><li><a href="Fleet.html">Fleet</a><ul class='methods'><li data-type='method'><a href="Fleet.html#info">info</a></li><li data-type='method'><a href="Fleet.html#invite">invite</a></li><li data-type='method'><a href="Fleet.html#kick">kick</a></li><li data-type='method'><a href="Fleet.html#members">members</a></li><li data-type='method'><a href="Fleet.html#move">move</a></li><li data-type='method'><a href="Fleet.html#update">update</a></li></ul></li><li><a href="Freeports.html">Freeports</a><ul class='methods'><li data-type='method'><a href="Freeports.html#all">all</a></li></ul></li><li><a href="Group.html">Group</a><ul class='methods'><li data-type='method'><a href="Group.html#info">info</a></li></ul></li><li><a href="Groups.html">Groups</a><ul class='methods'><li data-type='method'><a href="Groups.html#all">all</a></li><li data-type='method'><a href="Groups.html#get">get</a></li></ul></li><li><a href="Incursions.html">Incursions</a><ul class='methods'><li data-type='method'><a href="Incursions.html#all">all</a></li></ul></li><li><a href="Industry.html">Industry</a><ul class='methods'><li data-type='method'><a href="Industry.html#facilities">facilities</a></li><li data-type='method'><a href="Industry.html#systemCosts">systemCosts</a></li></ul></li><li><a href="Insurance.html">Insurance</a><ul class='methods'><li data-type='method'><a href="Insurance.html#prices">prices</a></li></ul></li><li><a href="Killmail.html">Killmail</a><ul class='methods'><li data-type='method'><a href="Killmail.html#get">get</a></li></ul></li><li><a href="Label.html">Label</a><ul class='methods'><li data-type='method'><a href="Label.html#del">del</a></li></ul></li><li><a href="Labels.html">Labels</a><ul class='methods'><li data-type='method'><a href="Labels.html#all">all</a></li><li data-type='method'><a href="Labels.html#create">create</a></li><li data-type='method'><a href="Labels.html#get">get</a></li></ul></li><li><a href="Mail.html">Mail</a><ul class='methods'><li data-type='method'><a href="Mail.html#all">all</a></li><li data-type='method'><a href="Mail.html#cspaCost">cspaCost</a></li><li data-type='method'><a href="Mail.html#get">get</a></li><li data-type='method'><a href="Mail.html#inbox">inbox</a></li><li data-type='method'><a href="Mail.html#lists">lists</a></li><li data-type='method'><a href="Mail.html#send">send</a></li><li data-type='method'><a href="Mail.html#unreadCount">unreadCount</a></li></ul></li><li><a href="Message.html">Message</a><ul class='methods'><li data-type='method'><a href="Message.html#del">del</a></li><li data-type='method'><a href="Message.html#info">info</a></li><li data-type='method'><a href="Message.html#update">update</a></li></ul></li><li><a href="PlanetaryInteraction.html">PlanetaryInteraction</a><ul class='methods'><li data-type='method'><a href="PlanetaryInteraction.html#schematic">schematic</a></li></ul></li><li><a href="Races.html">Races</a><ul class='methods'><li data-type='method'><a href="Races.html#all">all</a></li></ul></li><li><a href="Region.html">Region</a><ul class='methods'><li data-type='method'><a href="Region.html#buyOrdersFor">buyOrdersFor</a></li><li data-type='method'><a href="Region.html#history">history</a></li><li data-type='method'><a href="Region.html#orders">orders</a></li><li data-type='method'><a href="Region.html#ordersFor">ordersFor</a></li><li data-type='method'><a href="Region.html#sellOrdersFor">sellOrdersFor</a></li></ul></li><li><a href="Regions.html">Regions</a><ul class='methods'><li data-type='method'><a href="Regions.html#get">get</a></li><li data-type='method'><a href="Regions.html#names">names</a></li></ul></li><li><a href="Search.html">Search</a><ul class='methods'><li data-type='method'><a href="Search.html#get">get</a></li><li data-type='method'><a href="Search.html#strict">strict</a></li></ul></li><li><a href="SolarSystem.html">SolarSystem</a><ul class='methods'><li data-type='method'><a href="SolarSystem.html#info">info</a></li></ul></li><li><a href="SolarSystems.html">SolarSystems</a><ul class='methods'><li data-type='method'><a href="SolarSystems.html#get">get</a></li><li data-type='method'><a href="SolarSystems.html#names">names</a></li></ul></li><li><a href="Sovereignty.html">Sovereignty</a><ul class='methods'><li data-type='method'><a href="Sovereignty.html#campaigns">campaigns</a></li><li data-type='method'><a href="Sovereignty.html#structures">structures</a></li></ul></li><li><a href="Squad.html">Squad</a><ul class='methods'><li data-type='method'><a href="Squad.html#remove">remove</a></li><li data-type='method'><a href="Squad.html#rename">rename</a></li></ul></li><li><a href="Squads.html">Squads</a><ul class='methods'><li data-type='method'><a href="Squads.html#add">add</a></li><li data-type='method'><a href="Squads.html#get">get</a></li></ul></li><li><a href="Station.html">Station</a><ul class='methods'><li data-type='method'><a href="Station.html#info">info</a></li></ul></li><li><a href="Stations.html">Stations</a><ul class='methods'><li data-type='method'><a href="Stations.html#get">get</a></li><li data-type='method'><a href="Stations.html#names">names</a></li></ul></li><li><a href="Structure.html">Structure</a><ul class='methods'><li data-type='method'><a href="Structure.html#buyOrdersFor">buyOrdersFor</a></li><li data-type='method'><a href="Structure.html#info">info</a></li><li data-type='method'><a href="Structure.html#orders">orders</a></li><li data-type='method'><a href="Structure.html#ordersFor">ordersFor</a></li><li data-type='method'><a href="Structure.html#sellOrdersFor">sellOrdersFor</a></li></ul></li><li><a href="Structures.html">Structures</a><ul class='methods'><li data-type='method'><a href="Structures.html#get">get</a></li></ul></li><li><a href="Type.html">Type</a><ul class='methods'><li data-type='method'><a href="Type.html#info">info</a></li></ul></li><li><a href="Types.html">Types</a><ul class='methods'><li data-type='method'><a href="Types.html#all">all</a></li><li data-type='method'><a href="Types.html#get">get</a></li><li data-type='method'><a href="Types.html#names">names</a></li><li data-type='method'><a href="Types.html#prices">prices</a></li></ul></li><li><a href="War.html">War</a><ul class='methods'><li data-type='method'><a href="War.html#info">info</a></li><li data-type='method'><a href="War.html#killmails">killmails</a></li><li data-type='method'><a href="War.html#kills">kills</a></li></ul></li><li><a href="Wars.html">Wars</a><ul class='methods'><li data-type='method'><a href="Wars.html#get">get</a></li><li data-type='method'><a href="Wars.html#recent">recent</a></li></ul></li><li><a href="Window.html">Window</a><ul class='methods'><li data-type='method'><a href="Window.html#contract">contract</a></li><li data-type='method'><a href="Window.html#info">info</a></li><li data-type='method'><a href="Window.html#market">market</a></li><li data-type='method'><a href="Window.html#newMail">newMail</a></li></ul></li><li><a href="Wing.html">Wing</a><ul class='methods'><li data-type='method'><a href="Wing.html#remove">remove</a></li><li data-type='method'><a href="Wing.html#rename">rename</a></li></ul></li><li><a href="Wings.html">Wings</a><ul class='methods'><li data-type='method'><a href="Wings.html#add">add</a></li><li data-type='method'><a href="Wings.html#all">all</a></li><li data-type='method'><a href="Wings.html#get">get</a></li></ul></li><li><a href="Wormholes.html">Wormholes</a></li></ul><h3>Modules</h3><ul><li><a href="module-eve_swagger_interface.html">eve_swagger_interface</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">api/character/CharacterCorporation.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const Promise = require('bluebird');

/**
 * An api adapter that provides functions for accessing various details for a
 * corporation specified by id via functions in the
 * [corporation](https://esi.tech.ccp.is/latest/#/Corporation) ESI endpoints.
 * Unlike {@link Corporation}, his only includes all corporation end points,
 * including those requiring access tokens. Additionally, this corporation
 * adapter is attached to a character so it always reports information on the
 * character's corporation.
 *
 * You should not usually instantiate this directly as its constructor requires
 * an internal api instance.
 */
class CharacterCorporation {
  /**
   * Create a new corporation api adapter for the particular character's
   * corporation.
   *
   * @param api {ApiProvider} The api provider
   * @param characterId {Number} The character this is linked to
   * @param token {String} The SSO access token for the character
   */
  constructor(api, characterId, token) {
    this._api = api;
    this._charId = characterId;
    this._token = token;
    this._id = null;
  }

  /**
   * Get the character's corporation's public info from the ESI endpoint.
   * Besides being defined against a particular character, this is equivalent to
   * {@link Corporation#info}.
   *
   * @return {Promise} A Promise that resolves to the response of the request
   */
  info() {
    if (this._id) {
      return this._api.corporation()
      .newRequest('getCorporationsCorporationId', [this._id]);
    } else {
      return this.id().then(corpId => {
        return this._api.corporation()
        .newRequest('getCorporationsCorporationId', [corpId]);
      });
    }
  }

  /**
   * Get the character's corporation's alliance history from the ESI endpoint.
   * Besides being defined against a particular character, this is equivalent to
   * {@link Corporation#history}.
   *
   * @return {Promise} A Promise that resolves to the response of the request
   */
  history() {
    if (this._id) {
      return this._api.corporation()
      .newRequest('getCorporationsCorporationIdAllianceHistory', [this._id]);
    } else {
      return this.id().then(corpId => {
        return this._api.corporation()
        .newRequest('getCorporationsCorporationIdAllianceHistory', [corpId]);
      });
    }
  }


  /**
   * Get the character's corporation's icon URLs from the ESI endpoint. Besides
   * being defined against a particular character, this is equivalent to {@link
      * Corporation#icon}.
   *
   * @return {Promise} A Promise that resolves to the response of the request
   */
  icon() {
    if (this._id) {
      return this._api.corporation()
      .newRequest('getCorporationsCorporationIdIcons', [this._id]);
    } else {
      return this.id().then(corpId => {
        return this._api.corporation()
        .newRequest('getCorporationsCorporationIdIcons', [corpId]);
      });
    }
  }

  /**
   * Get the character's corporation's member list from the ESI endpoint. This
   * makes an HTTP GET request to
   * [`corporations/{id}/members/`](https://esi.tech.ccp.is/latest/#!/Corporation/get_corporations_corporation_id_members).
   * The request is returned as an asynchronous Promise that resolves to an
   * array of character ids. An example value looks like:
   *
   * ```
   * [
   *   90000001,
   *   90000002
   * ]
   * ```
   *
   * @return {Promise} A Promise that resolves to the response of the request
   * @esi_link CorporationApi.getCorporationsCorporationIdMembers
   */
  members() {
    if (this._id) {
      return this._api.corporation(this._token)
      .newRequest('getCorporationsCorporationIdMembers', [this._id])
      .then(members => members.map(m => m.character_id));
    } else {
      return this.id().then(corpId => {
        return this._api.corporation(this._token)
        .newRequest('getCorporationsCorporationIdMembers', [corpId])
        .then(members => members.map(m => m.character_id));
      })
    }
  }

  /**
   * Get the character's corporation's member list with roles for each
   * character
   * from the ESI endpoint. The character must have the personalle manager or
   * any other grantable role in order for this request to succeed. This makes
   * an HTTP GET request to
   * [`corporations/{id}/roles/`](https://esi.tech.ccp.is/latest/#!/Corporation/get_corporations_corporation_id_roles).
   * The request is returned as an asynchronous Promise that resolves to an
   * array parsed from the response JSON model. An example value looks like:
   *
   * ```
   * [
   *   {
   *     "character_id": 1000171,
   *     "roles": [
   *       "Director",
   *       "Station_Manager"
   *     ]
   *   }
   * ]
   * ```
   *
   * @return {Promise} A Promise that resolves to the response of the request
   * @esi_link CorporationApi.getCorporationsCorporationIdRoles
   */
  roles() {
    if (this._id) {
      return this._api.corporation(this._token)
      .newRequest('getCorporationsCorporationIdRoles', [this._id]);
    } else {
      return this.id().then(corpId => {
        return this._api.corporation(this._token)
        .newRequest('getCorporationsCorporationIdRoles', [corpId]);
      })
    }
  }

  /**
   * Get the corporation id of the corp that the character belongs to.
   *
   * @returns {Promise} A Promise that resolves to the character's corporation
   *     id
   */
  id() {
    if (this._id) {
      return Promise.resolve(this._id);
    } else {
      return this._api.character()
      .newRequest('getCharactersCharacterId', [this._charId])
      .then(result => {
        let id = result.corporation_id;
        this._id = id;
        return id;
      });
    }
  }
}

module.exports = CharacterCorporation;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Feb 02 2017 14:25:48 GMT-0600 (CST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
